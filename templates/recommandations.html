<!doctype html>
<html lang="en">
{% extends 'bootstrap/base.html' %}

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    {{ fontawesome_html() }}
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel='stylesheet' href="{{ url_for('static', filename='font-awesome/css/font-awesome.min.css')}}">
    <title>Sparql Movies</title>
</head>
{%block content%}

<body>
    <header class="jumbotron p-5 text-center bg-image">
        <h1 class="">Movies recommendation tool using Sparql</h1>
    </header>
    <div class = "container-fluid">
    {%for movie in main_movie%}
        <div class = 'row ml-4' style="height:15%;width:100%">
            <div class = 'col container mr-6'>
                <div class = "row">
                    <h2 class = "row text-center text-uppercase font-weight-bold ml-10">{{movie.title}}</h2>
                </div>
                <h5 class = "row text-right">{{movie.director}}</h5>
                <h6 class = "row text-right">Genres:  </h6>{{tags_fromlist(movie.genres) | safe}}
                <h6 class = "row text-right mt-2">Actors: {{p_fromlist(movie.actors) | safe}}</h6>
                <h6 class = "row text-right">Review score:</h6> {{score_bar(movie.score) | safe}}
                <div class="row">
                    <a href="{{movie.wikiurl}}" class="btn btn-secondary m-2"><span class="label">wikidata</span></a>
                    <a href="/recommandation={{movie.uri}}" class="btn btn-secondary m-2">recommendations based on this movie</a>
                    <i class="fa fa-wikipedia-w" aria-hidden="true"></i>
                </div>
            </div>
            <div class="col container" style="height:15%">
                {% if movie.poster_internal_url %}
                <img class="img-thumbnail rounded float-left"
                    style="height:100%;max-width:100%;"
                    src="{{url_for('static',filename=movie.poster_internal_url)}}"
                    alt="{{movie.title}}_poster"/>
                {% endif %}
            </div>
        </div>
        <hr>
    {%endfor%}
    </div>
    <div id = "accordion">
        {%for reco in results.recommandations%}
        <div class="card">
            <div class="card-header" id="heading{{reco.id}}">
                <h5 class="mb-0">
                    <button class="btn btn-link" data-toggle="collapse" data-target="#collapse{{reco.id}}" aria-expanded="false" aria-controls="collapse{{reco.id}}">
                        {{reco.text}}
                    </button>
                  </h5>
            </div>
            <div class="collapse" id="collapse{{reco.id}}">
                <div class="card-body">
                    <div class='card-columns m-4'>
                        {%for movie in reco.data%}
                            <div class ='card m-2' style='height:15%;width:40%;'>
                                <div class = 'card-body'>
                                    <h5 class = "card-title">{{movie.title}}</h5>
                                    {% if movie.reco != '' %}
                                        <h6 class = "card-text">Recommendation based on: {{movie.reco}}</h6>
                                    {% endif %}
                                    {{score_bar(movie.score, 'Relevance : ') | safe}}
                                </div>
                                <div class="card-footer align-items-center">
                                    <a href="{{movie.wikiurl}}" class="btn btn-secondary ml-1 mb-1"><span class="label">Wiki</span></a>
                                    <a href="{{url_for('recommandation',movie=movie.to_json())}}"  class="btn btn-secondary mr-1 mb-1">More informations</a>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    <footer class="text-center text-lg-start text-white" style="background-color: #3e4551">
        <div class="container p-4 pb-0">
            <div class="row">
                <div class="col-8">
                    <h5 class="text-uppercase">PROJECT INFORMATIONS</h5>
                    <div class="align-bottom"> Developped by Jérôme Auguste, Nathan Bruckmann, Ruben Partouche</div>
                </div>
                <div class="col-4">
                    <div class="align-bottom"> Using Sparql endpoints : wikidata, dbpedia</div>
                </div>
            </div>

            <hr class="mb-4" />
            <section class="mb-4 text-center">
                <a class="btn btn-outline-light btn-floating m-1" href="https://github.com/jerome-auguste/Movie-Selector" role="button">
                    <i class='fas fa-github'></i>
                    Github
                </a>
            </section>
        </div>
    </footer>

</body>
{%endblock%}

</html>